---
title: "HW2: Visualizing FEMA NRI Data"
format: html
---
# HW #2: Visualizing FEMA NRI Data

## Objective
How do FEMA National Risk Index scores for counties in California compare to those in other states? 

```{r}
#| label: Set-Up
#| output: false
#| message: false 

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##                                    setup                                 ----
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#..........................load packages.........................
library(tidyverse)
library(here)
library(ggplot2)
library(janitor)

#..........................import data...........................
 nri_df <- read_csv(here::here("data", "National_Risk_Index_Counties_807384124455672111.csv")) %>% 
   clean_names()
 

##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
##                            wrangle nri data                         
##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 # Filter for only US states
 nri_2 <- nri_df %>% 
   filter(!state_name %in% c("Puerto Rico", "Guam", "Virgin Islands", "Northern Mariana Islands", "American Samoa", "District of Columbia")) %>% 
  # Group by state 
   group_by(state_name) %>% 
   # Count the total number of counties
   summarize(total_counties = n(), 
             # Sum the counties considered high risk (percentile > 84.32)
             high_risk_counties = sum(national_risk_index_state_percentile_composite > 84.32, na.rm = TRUE), 
             # Find the proportion of high risk in each county 
             prop_high_risk_counties = high_risk_counties/total_counties) %>% 
  mutate(ca_true_false = state_name == "California")
 
 # group by county 
 
 #  if a given county’s Risk Index percentile for a hazard type is 84.32 then its Risk Index value is greater than 84.32% of all US counties. 
 
 # filter national_risk_index_state_percentile_composite   for those above 84.32 (if-then statement)
 
 # risk rating (categorical)
 
 
```

```{r}

nri_2 %>% 
  # Get the top 15 high risk states 
  slice_max(prop_high_risk_counties, n = 15) %>% 
  # Reorder state by proportion
ggplot(aes(x = reorder(state_name, prop_high_risk_counties), 
             y = prop_high_risk_counties)) +
  geom_col() +
  # Highlight California 
  gghighlight::gghighlight(state_name == "California") +
  coord_flip()

```


```{r}
nri_2 %>%
  # Get the top 15 high risk states 
  slice_max(prop_high_risk_counties, n = 15) %>%
  ggplot(aes(x = prop_high_risk_counties, 
             y = reorder(state_name, prop_high_risk_counties),
             color = ca_true_false)) +
  geom_linerange(aes(xmin = 0, xmax = prop_high_risk_counties)) + 
  geom_point(size = 3) +
  theme_minimal()
```


 
 identify / jot down your variables of interest and consider which data types they are
use online tools like from Data to Viz to help determine appropriate graph types, given your variables
roughly sketch out your plots by hand (see why this step matters!)

## Questions

**1. What are your variables of interest and what kinds of data (e.g. numeric, categorical, ordered, etc.) are they (a bullet point list is fine)?**

**2. How did you decide which type of graphic form was best suited for answering the question? What alternative graphic forms could you have used instead? Why did you settle on this particular graphic form?**

**3. Summarize your main finding in no more than two sentences.**

**4. What modifications did you make to this visualization to make it more easily readable?**

**5. Is there anything you wanted to implement, but didn’t know how? If so, please describe.**
